install.packages("ggplot2")
install.packages("jiebaR")
install.packages("wordcloud2")
library(wordcloud2)
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
cnn<-read.csv("data/CNN.csv",header = T,sep=",",encoding = "UTF-8")
lstm<-read.csv("data/LSTM.csv",header = T,sep=",",encoding = "UTF-8")
cnn$method<-c("cnn")
lstm$method<-c("lstm")
data<-rbind(cnn,lstm)
data$Step<-data$Step+1
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
p1<-ggplot(data,aes(x=Step,y=Value,color=method,group=method))+geom_line(size=1)
p1<-p1+labs(title = "两种神经网络准确率随迭代次数的变化",x = "迭代次数 ", y = "准确率")
p1<-p1+scale_color_manual(values=c("#000099","#56B4E9"))
p1<-p1+theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
p1<-p1+noblank
怕
p1
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
cnn<-read.csv("data/CNN.csv",header = T,sep=",",encoding = "UTF-8")
lstm<-read.csv("data/LSTM.csv",header = T,sep=",",encoding = "UTF-8")
cnn$method<-c("cnn")
lstm$method<-c("lstm")
data<-rbind(cnn,lstm)
data$Step<-data$Step+1
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
p1<-ggplot(data,aes(x=Step,y=Value,color=method,group=method))+geom_line(size=1)
p1<-p1+labs(title = "两种神经网络准确率随迭代次数的变化",x = "迭代次数 ", y = "准确率")
p1<-p1+scale_color_manual(values=c("#000099","#56B4E9"))
p1<-p1+theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
p1<-p1+noblank
ggsave(p1,file="img/两种神经网络准确率随迭代次数的变化.png",width=8,height=4)
pdf("img/pdf/两种神经网络准确率随迭代次数的变化.pdf",width=8,height=6)
p1
dev.off()
method<-c("CNN","LSTM","Naive Bayes")
q<-c(0.92,0.86,0.847)
data_z<-data.frame(method,q)
p2<-ggplot(data_z,aes(x=method,y=q,fill=method))+geom_bar(stat = "identity",width = 0.5)+ ylim(0,1)
p2<-p2+labs(title = "三种算法准确率比较",x = "算法 ", y = "准确率")
p2<-p2+noblank+scale_fill_hue(l=50)+geom_text(aes(label=q), vjust=-0.2)+ theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
ggsave(p2,file="img/三种算法准确率比较.png",width=8,height=6)
pdf("img/pdf/三种算法准确率比较.pdf",width=8,height=6)
p2
dev.off()
method<-c("CNN","LSTM","Naive Bayes")
q<-c(0.92,0.86,0.847)
data_z<-data.frame(method,q)
p2<-ggplot(data_z,aes(x=method,y=q,fill=method))+geom_bar(stat = "identity",width = 0.5)+ ylim(0,1)
p2<-p2+labs(title = "三种算法准确率比较",x = "算法 ", y = "准确率")
p2<-p2+noblank+scale_fill_hue(l=30)+geom_text(aes(label=q), vjust=-0.2)+ theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
p2
ggsave(p2,file="img/三种算法准确率比较.png",width=8,height=6)
pdf("img/pdf/三种算法准确率比较.pdf",width=8,height=6)
p2
dev.off()
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
View(data_t)
pos_t<-data_t[which(data_t$label==1)]
pos_t<-data_t[data_t(data_t$label==1)]
pos_t<-data_t[data_t[data_t$label==1]
pos_t<-data_t[data_t[data_t$label==1]]
data_t[data_t$label==1]
data_t$label==1
data_t[data_t$label==1]
data_t$label[data_t$label==1]
which(data_t$label==1)
pos_t<-data_t[which(data_t$label==1)]
data_t<-as.matrix(read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8"))
pos_t<-data_t[which(data_t$label==1)]
View(data)
data_t<-as.matrix(read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8"))
View(data_t)
pos_t<-data_t[which(data_t[,4]==1)]
which(data_t[,4]==1)
pos_t<-data_t[which(data_t[,4]==1),]
View(pos_t)
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
View(data_t)
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count,fill=count))
pt<-pt+noblank+font_and_title
pt<-pt+facet_wrap(~label,ncol=5)
.pt
t_all<-as.data.frame(table(data_all$phone,data_all$标签))
t_all<-cbind(t_all[,1],c(rep("all",20)),t_all[,2:3])
phone_num2<-as.data.frame(table(data_all$phone,data_all$site,data_all$标签))
names(t_all)<-c('phone','site','label','num')
names(phone_num2)<-c('phone','site','label','num')
phone_num2<-rbind(phone_num2,t_all)
setwd("D:/analysis")
library(ggplot2)
library(lubridate)
library(showtext)
# info_pos<-read.csv("data/info_pos.csv",header = FALSE,sep="\t",encoding = "UTF-8")
# info_neg<-read.csv("data/info_neg.csv",header = FALSE,sep="\t",encoding = "UTF-8")
data_all<-read.csv("data/info_all.csv",header = FALSE,sep="\t",encoding = "UTF-8")
# names(info_pos)<-c('phone','size','color','star','date','site')
# names(info_neg)<-c('phone','size','color','star','date','site')
names(data_all)<-c('phone','size','color','star','date','site','label')
site=as.matrix(data_all$site)
for(i in 1:length(site)){
if(site[i]=="it"){
site[i]<-"意大利"
}
}
data_all$site<-site
data_all$标签<-data_all$label
data_all$标签[data_all$标签==1]<-"好评"
data_all$标签[data_all$标签==0]<-"差评"
data_all$month<-apply(as.matrix(data_all$date), 1, month)
data_all$quarter<-apply(as.matrix(data_all$date), 1, quarter)
data_all$year<-apply(as.matrix(data_all$date), 1, year)
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
windowsFonts(A=windowsFont("Times New Roman"), H=windowsFont("微软雅黑"))
font_and_title<-theme(plot.title = element_text(hjust = 0.5,size=16,family="H"))
t_all<-as.data.frame(table(data_all$phone,data_all$标签))
t_all<-cbind(t_all[,1],c(rep("all",20)),t_all[,2:3])
phone_num2<-as.data.frame(table(data_all$phone,data_all$site,data_all$标签))
names(t_all)<-c('phone','site','label','num')
names(phone_num2)<-c('phone','site','label','num')
phone_num2<-rbind(phone_num2,t_all)
View(phone_num2)
pt<-pt+geom_bar(stat='identity',position = "fill")
pt
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank+font_and_title
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity',position = "fill")
pt
pt<-pt+geom_bar(stat='identity')
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity')
pt
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity')
pt
View(data_t)
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity')
pt
pt<-ggplot(data_t,aes(x=star,y=count,color=star))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity')
pt
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity')
pt
pt<-pt+geom_text(aes(label=q), vjust=-0.2)
pt
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity')
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt
pt<-pt+geom_bar(stat='identity',color="blue")
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity')
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity')
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt
pdf("img/pdf/结果统计.pdf",width=8,height=6)
pt
dev.off()
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity')
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt<-pt+labs(title = "预测结果统计",x = "星级", y = "条数")+theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
pdf("img/pdf/结果统计.pdf",width=8,height=6)
pt
dev.off()
pt<-pt+geom_bar(stat='identity',fill="blue")
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt<-pt+labs(title = "预测结果统计",x = "星级", y = "条数")+theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
pdf("img/pdf/结果统计.pdf",width=8,height=6)
pt
dev.off()
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity',fill="blue")
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt<-pt+labs(title = "预测结果统计",x = "星级", y = "条数")+theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
pdf("img/pdf/结果统计.pdf",width=8,height=6)
pt
dev.off()
pt<-pt+geom_bar(stat='identity',fill="#4169E1")
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt<-pt+labs(title = "预测结果统计",x = "星级", y = "条数")+theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
pdf("img/pdf/结果统计.pdf",width=8,height=6)
pt
dev.off()
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity',fill="#4169E1")
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt<-pt+labs(title = "预测结果统计",x = "星级", y = "条数")+theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
pdf("img/pdf/结果统计.pdf",width=8,height=6)
pt
dev.off()
setwd("D:/analysis")
library(ggplot2)
library(showtext)
showtext.auto(enable = TRUE)
font.add('SimSun', 'simsun.ttc','Times New Roman')
data_t<-read.csv("data/结果统计.csv",header = T,sep=",",encoding = "UTF-8")
noblank<-theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black"))
pt<-ggplot(data_t,aes(x=star,y=count))
pt<-pt+noblank
pt<-pt+facet_wrap(~label,ncol=2)
pt<-pt+geom_bar(stat='identity',fill="#4169E1")
pt<-pt+geom_text(aes(label=p), vjust=-0.2)
pt<-pt+labs(title = "预测结果统计",x = "星级", y = "条数")+theme(plot.title = element_text(size=16,hjust = 0.5),text=element_text(size = 16,family = "The New Roman"))
pdf("img/pdf/结果统计.pdf",width=8,height=4)
pt
dev.off()
